<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>VideoCX Janus UI (TS) - Virtual BG + Screen Share</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <style>
    html, body { height: 100%; margin: 0; }
    body { background: #f5f7fb; overflow: hidden; }
    .stage { position: relative; width: 100%; height: 100%; }
    .remote-wrap { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; padding:24px; }
    #remoteVideo { max-width:min(900px,85vw); max-height:min(520px,75vh); width:100%; height:auto; border-radius:10px; background:#000; box-shadow:0 10px 30px rgba(0,0,0,.15); }
    .local-pip { position:absolute; right:18px; bottom:18px; width:220px; height:140px; border-radius:10px; overflow:hidden; background:#000; border:2px solid #fff; z-index:5; box-shadow:0 10px 30px rgba(0,0,0,.18);}
    #localVideo { width:100%; height:100%; object-fit:cover; transform:scaleX(-1); }
    .controls { position:absolute; left:18px; top:18px; display:flex; flex-direction:column; gap:12px; z-index:10; }
    .ctrl-btn { width:44px; height:44px; border-radius:999px; border:0; color:#fff; font-size:18px; cursor:pointer; box-shadow:0 6px 18px rgba(0,0,0,.12); background:#2d7cf6; }
    .ctrl-btn.neutral{ background:#4b5563; }
    .ctrl-btn.danger{ background:#e11d48; }
    .ctrl-btn.green{ background:#16a34a; }
    .ctrl-btn.purple{ background:#7c3aed; }
    .ctrl-btn:disabled{ opacity:.45; cursor:not-allowed; }
    .reconnect { position:absolute; left:18px; bottom:18px; padding:10px 14px; border-radius:6px; border:0; background:#f97316; color:white; font-weight:600; box-shadow:0 6px 18px rgba(0,0,0,.12); z-index:10; }
    .status { position:absolute; top:18px; right:18px; background:rgba(255,255,255,.9); border-radius:8px; padding:10px 12px; max-width:46vw; box-shadow:0 6px 18px rgba(0,0,0,.08); z-index:10; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Courier New", monospace;}
    .status .small{ color:#6b7280; font-size:12px; margin-top:4px; }
  
    .overlay-label{position:absolute;left:10px;top:10px;background:rgba(0,0,0,.55);color:#fff;padding:4px 8px;border-radius:999px;font-size:12px;z-index:6}
    .local-overlay{position:absolute;left:8px;top:8px}
    .remote-overlay{position:absolute;left:8px;top:8px}
    .ended-overlay{position:absolute;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.5);color:#fff;font-size:26px;font-weight:700;z-index:7}
    .quality-badge{position:absolute;right:8px;top:8px;background:rgba(0,0,0,.55);color:#fff;padding:4px 8px;border-radius:8px;font-size:12px;z-index:6;cursor:pointer}
    .quality-details{position:absolute;right:8px;top:34px;background:rgba(0,0,0,.7);color:#fff;padding:6px 8px;border-radius:8px;font-size:11px;display:none;z-index:6;max-width:260px}
    .quality-details.show{display:block}

  </style>
</head>
<body>
<div class="stage">
  <div class="controls">
    <button id="btnMute" class="ctrl-btn" title="Mute/Unmute" disabled><i class="fa-solid fa-microphone"></i></button>
    <button id="btnUnpublish" class="ctrl-btn neutral" title="Stop Video" disabled><i class="fa-solid fa-video"></i></button>
    <button id="btnScreen" class="ctrl-btn green" title="Start Screen Share" disabled><i class="fa-solid fa-display"></i></button>
    <button id="btnVB" class="ctrl-btn purple" title="Toggle Virtual Background" disabled><i class="fa-solid fa-wand-magic-sparkles"></i></button>

    <!-- âœ… Added Recording button ABOVE End/Hangup (no other changes) -->
    <button id="btnRecord" title="Start Recording"> <i class="fa-solid fa-circle"></i></button>

    <button id="btnLeave" class="ctrl-btn danger" title="Hangup" disabled><i class="fa-solid fa-phone-slash"></i></button>
  </div>

  <button id="btnReconnect" class="reconnect" disabled>Re-Connect</button>

  <div class="status">
    <div id="statusLine">Idle</div>
    <div id="sessionInfo" class="small"></div>
  </div>

  <div class="remote-wrap">
    <video id="remoteVideo" autoplay playsinline></video>
    <div id="remoteOverlay" class="overlay-label remote-overlay">Remote</div>
    <div id="remoteQuality" class="quality-badge">Remote: -</div>
    <div id="remoteQualityDetails" class="quality-details">-</div>
    <div id="endedOverlay" class="ended-overlay">Call is ended</div>
  </div>

  <div class="local-pip">
    <video id="localVideo" autoplay playsinline muted></video>
    <div id="localOverlay" class="overlay-label local-overlay">Local</div>
    <div id="localQuality" class="quality-badge">Local: -</div>
    <div id="localQualityDetails" class="quality-details">-</div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/webrtc-adapter@8.2.3/out/adapter.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/selfie_segmentation/selfie_segmentation.js"></script>
<script src="https://janus.conf.meetecho.com/demos/janus.js"></script>
<script src="./dist/app.js"></script>
</body>
</html>